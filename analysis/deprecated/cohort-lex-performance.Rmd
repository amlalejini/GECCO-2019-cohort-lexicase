---
title: "Cohort Lexicase - Performance Analysis"
output: 
  html_document: 
    keep_md: true
    toc: true
    toc_float: true
    collapsed: false
    theme: default
  pdf_document: default
---

## Dependencies

```{r}
library(readr)
library(tidyr)
library(ggplot2)
library(plyr)
library(reshape2)
library(cowplot)
library(rcompanion)

source("https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R")
```

## Load data

```{r}
# Load data for final experiment runs.
solutions_u100_data_loc <- "../data/exp-data/min_programs__update_100.csv"
solutions_u100_summary_data_loc <- "../data/exp-data/min_programs__update_100__solutions_summary.csv"

solutions_u300_data_loc <- "../data/exp-data/min_programs__update_300.csv"
solutions_u300_summary_data_loc <- "../data/exp-data/min_programs__update_300__solutions_summary.csv"

solutions_e26214400_data_loc <- "../data/exp-data/min_programs__eval_26214400.csv"
solutions_e26214400_summary_data_loc <- "../data/exp-data/min_programs__eval_26214400__solutions_summary.csv"

solutions_e78643200_data_loc <- "../data/exp-data/min_programs__eval_78643200__modified.csv"
solutions_e78643200_summary_data_loc <- "../data/exp-data/min_programs__eval_78643200__solutions_summary.csv"

prog_solutions_u100 <- read.csv(solutions_u100_data_loc, na.strings = "NONE")
prog_solutions_u100_summary <- read.csv(solutions_u100_summary_data_loc, na.strings = "NONE")

prog_solutions_u300 <- read.csv(solutions_u300_data_loc, na.strings = "NONE")
prog_solutions_u300_summary <- read.csv(solutions_u300_summary_data_loc, na.strings = "NONE")

prog_solutions_e26214400 <- read.csv(solutions_e26214400_data_loc, na.strings = "NONE")
prog_solutions_e26214400_summary <- read.csv(solutions_e26214400_summary_data_loc, na.strings = "NONE")

prog_solutions_e78643200 <- read.csv(solutions_e78643200_data_loc, na.strings = "NONE")
prog_solutions_e78643200_summary <- read.csv(solutions_e78643200_summary_data_loc, na.strings = "NONE")
```

```{r}
prog_solutions_e78643200_summary$problem <- factor(prog_solutions_e78643200_summary$problem, levels=c('small-or-large','for-loop-index','compare-string-lengths','median','smallest', 'sum-of-squares'))
prog_solutions_e26214400_summary$problem <- factor(prog_solutions_e26214400_summary$problem, levels=c('small-or-large','for-loop-index','compare-string-lengths','median','smallest', 'sum-of-squares'))
# levels(prog_solutions_e78643200_summary$problem) <- c('small-or-large','for-loop-index','compare-string-lengths','median','smallest', 'sum-of-squares')
# levels(prog_solutions_e26214400_summary$problem) <- c('small-or-large','for-loop-index','compare-string-lengths','median','smallest', 'sum-of-squares')
problem_names <- c(
  'small-or-large'=        "Small or Large",
  'for-loop-index'=        "For Loop Index",
  'compare-string-lengths'="Comp. Str. Lengths",
  'median'=                "Median",
  'smallest'=              "Smallest"
)

```


## Quick Look (just show me some graphs real quick!)
```{r, echo=FALSE}
ggplot(data = filter(prog_solutions_e26214400_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 52) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem) + ggtitle("26214400 Evaluations (100 gens of std lex)")

ggplot(data = filter(prog_solutions_e78643200_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 52) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem) + ggtitle("7864320 Evaluations (300 gens of std lex)")
```
```{r, echo=FALSE}
ggplot(data = filter(prog_solutions_u100_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 50) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem) + ggtitle("100 Generations")

ggplot(data = filter(prog_solutions_u300_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 50) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem, nrow=1) + ggtitle("300 Generations")
```

## Fixing the number of evaluations

### Evaluation 26214400

```{r}

early_plt <- ggplot(data = filter(prog_solutions_e26214400_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("K (number of cohorts)") + ylab("Successful Runs")  +  ylim(0, 58) +
    scale_x_discrete(labels = c("1", "2", "4", "8", "16", "32", "64", "128", "256"), limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    theme(axis.text.x=element_text(size=10), axis.title.x = element_text(size=10)) + 
    coord_flip() + facet_wrap( ~ problem, labeller=as_labeller(problem_names), nrow=1) + 
    theme(strip.text.x = element_text(size = 9)) + 
    ggtitle("26214400 Evaluations")

later_plt <- ggplot(data = filter(prog_solutions_e78643200_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("K (number of cohorts)") + ylab("Successful Runs")  +  ylim(0, 52) +
    scale_x_discrete(labels = c("1", "2", "4", "8", "16", "32", "64", "128", "256"), limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    theme(axis.text.x=element_text(size=10), axis.title.x = element_text(size=10)) + 
    coord_flip() + facet_wrap( ~ problem, labeller=as_labeller(problem_names), nrow=1) + 
    theme(strip.text.x = element_text(size = 9)) + 
    ggtitle("7864320 Evaluations")

plt2gether<-plot_grid(early_plt, later_plt, labels=c("A", "B"), nrow=2, align = "v")
save_plot("fixed-evals-performance.pdf", plt2gether,
          ncol = 1, # we're saving a grid plot of 2 columns
          nrow = 2, # and 2 rows
          # each individual subplot should have an aspect ratio of 1.3
          base_aspect_ratio = 4
          )
plt2gether

 # ggplot(data = filter(prog_solutions_e78643200_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
#     geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 52) +
#     scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
#     guides(fill=FALSE)+
#     geom_text(aes(label=solutions_found), nudge_y=2) + 
#     coord_flip() + facet_wrap( ~ problem) + ggtitle("7864320 Evaluations (300 gens of std lex)")



# ggplot(data = filter(prog_solutions_e26214400_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
#     geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 52) +
#     scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
#     guides(fill=FALSE)+
#     geom_text(aes(label=solutions_found), nudge_y=2) + 
#     coord_flip() + facet_wrap( ~ problem) + ggtitle("26214400 Evaluations (100 gens of std lex)")
```


#### Problem - Compare string lengths

```{r}
prob_data <- filter(prog_solutions_e26214400_summary, problem=="compare-string-lengths" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - For loop index

```{r}
prob_data <- filter(prog_solutions_e26214400_summary, problem=="for-loop-index" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Median

```{r}
prob_data <- filter(prog_solutions_e26214400_summary, problem=="median" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Small or large

```{r}
prob_data <- filter(prog_solutions_e26214400_summary, problem=="small-or-large" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Smallest

```{r}
prob_data <- filter(prog_solutions_e26214400_summary, problem=="smallest" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```


### Evaluation 78643200

```{r}
ggplot(data = filter(prog_solutions_e78643200_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 52) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem) + ggtitle("7864320 Evaluations (300 gens of std lex)")
```


#### Problem - Compare string lengths

```{r}
prob_data <- filter(prog_solutions_e78643200_summary, problem=="compare-string-lengths" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - For loop index

```{r}
prob_data <- filter(prog_solutions_e78643200_summary, problem=="for-loop-index" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Median

```{r}
prob_data <- filter(prog_solutions_e78643200_summary, problem=="median" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Small or large

```{r}
prob_data <- filter(prog_solutions_e78643200_summary, problem=="small-or-large" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Smallest

```{r}
prob_data <- filter(prog_solutions_e78643200_summary, problem=="smallest" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```



## Fixing the number of generations

### Generation 100

_Too_ early to really see much of anything here.

```{r}
ggplot(data = filter(prog_solutions_u100_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 50) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem) + ggtitle("100 Generations")
```

### Generation 300

```{r}
ggplot(data = filter(prog_solutions_u300_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("Problem") + ylab("Successful Runs")  +  ylim(0, 50) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    coord_flip() + facet_wrap( ~ problem) + ggtitle("300 Generations")
```

### Paper figure!

```{r}
ggplot(data = filter(prog_solutions_u300_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
    geom_bar(stat="identity") + xlab("K (number of cohorts)") + ylab("Successful Runs")  +  ylim(0, 52) +
    scale_x_discrete(labels = c("1", "2", "4", "8", "16", "32", "64", "128", "256"), limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    guides(fill=FALSE)+
    geom_text(aes(label=solutions_found), nudge_y=2) + 
    theme(axis.text.x=element_text(size=10), axis.title.x = element_text(size=10)) + 
    coord_flip() + facet_wrap( ~ problem, labeller=as_labeller(problem_names), nrow=1) + 
    theme(strip.text.x = element_text(size = 9)) + 
    ggtitle("300 Generations") + ggsave("fixed-gens-performance.pdf", height=5, width=15)
```

#### Problem - Compare string lengths

```{r}
prob_data <- filter(prog_solutions_u300_summary, problem=="compare-string-lengths" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - For loop index

```{r}
prob_data <- filter(prog_solutions_u300_summary, problem=="for-loop-index" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Median

```{r}
prob_data <- filter(prog_solutions_u300_summary, problem=="median" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Small or large

```{r}
prob_data <- filter(prog_solutions_u300_summary, problem=="small-or-large" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```

#### Problem - Smallest

```{r}
prob_data <- filter(prog_solutions_u300_summary, problem=="smallest" & test_mode=="SEL_COHORT_LEX")
prob_data$successful_runs = prob_data$solutions_found
prob_data$failed_runs = prob_data$total_runs - prob_data$solutions_found
con_table <- matrix(c(prob_data$successful_runs, prob_data$failed_runs), nrow=length(prob_data$successful_runs))
rownames(con_table) <- prob_data$cohort_config
colnames(con_table) <- c("Successful Runs", "Failed Runs")
pairwiseNominalIndependence(con_table, fisher=TRUE, gtest=FALSE, chisq=FALSE, method="holm")
```



## Evaluations required before a solution was found

#### Problem - Compare string lengths

```{r}
ggplot(filter(prog_solutions_e78643200, problem=="compare-string-lengths" & sel_mode == "cohort lex"), mapping=aes(x=cohort_config, y=evaluation_first_solution_found, fill=cohort_config, colour=cohort_config)) +
    geom_flat_violin(position=position_nudge(x=.2, y=0), adjust=2) +
    geom_point(position = position_jitter(width = .15), size = .25) +
    geom_boxplot(aes(x = cohort_config, y = evaluation_first_solution_found),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
    ylab("Evaluations Required To Find Solution") + ylim(0, 78643200) + xlab("Cohort Configuration") + coord_flip() + guides(fill=FALSE, colour=FALSE) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    ggtitle("Number of evaluations before a solution was found\nCompare String Lengths")
```

```{r}
eval_data <- filter(prog_solutions_e78643200, problem=="compare-string-lengths" & sel_mode == "cohort lex" & !is.na(evaluation_first_solution_found))
kruskal.test(evaluation_first_solution_found ~ cohort_config, eval_data)
pairwise.wilcox.test(x=eval_data$evaluation_first_solution_found, g=eval_data$cohort_config, exact=FALSE, p.adjust.method = "holm")
```

#### Problem - For loop index

```{r}
ggplot(filter(prog_solutions_e78643200, problem=="for-loop-index" & sel_mode == "cohort lex"), mapping=aes(x=cohort_config, y=evaluation_first_solution_found, fill=cohort_config, colour=cohort_config)) +
    geom_flat_violin(position=position_nudge(x=.2, y=0), adjust=2) +
    geom_point(position = position_jitter(width = .15), size = .25) +
    geom_boxplot(aes(x = cohort_config, y = evaluation_first_solution_found),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
    ylab("Evaluations Required To Find Solution") + ylim(0, 78643200) + xlab("Cohort Configuration") + coord_flip() + guides(fill=FALSE, colour=FALSE) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    ggtitle("Number of evaluations before a solution was found\nFor Loop Index")
```

```{r}
eval_data <- filter(prog_solutions_e78643200, problem=="for-loop-index" & sel_mode == "cohort lex" & !is.na(evaluation_first_solution_found))
kruskal.test(evaluation_first_solution_found ~ cohort_config, eval_data)
pairwise.wilcox.test(x=eval_data$evaluation_first_solution_found, g=eval_data$cohort_config, exact=FALSE, p.adjust.method = "holm")
```

#### Problem - Median

```{r}
ggplot(filter(prog_solutions_e78643200, problem=="median" & sel_mode == "cohort lex"), mapping=aes(x=cohort_config, y=evaluation_first_solution_found, fill=cohort_config, colour=cohort_config)) +
    geom_flat_violin(position=position_nudge(x=.2, y=0), adjust=2) +
    geom_point(position = position_jitter(width = .15), size = .25) +
    geom_boxplot(aes(x = cohort_config, y = evaluation_first_solution_found),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
    ylab("Evaluations Required To Find Solution") + ylim(0, 78643200) + xlab("Cohort Configuration") + coord_flip() + guides(fill=FALSE, colour=FALSE) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    ggtitle("Number of evaluations before a solution was found\nMedian")
```

```{r}
eval_data <- filter(prog_solutions_e78643200, problem=="median" & sel_mode == "cohort lex" & !is.na(evaluation_first_solution_found))
kruskal.test(evaluation_first_solution_found ~ cohort_config, eval_data)
pairwise.wilcox.test(x=eval_data$evaluation_first_solution_found, g=eval_data$cohort_config, exact=FALSE, p.adjust.method = "holm")
```

#### Problem - Small or large

```{r}
ggplot(filter(prog_solutions_e78643200, problem=="small-or-large" & sel_mode == "cohort lex"), mapping=aes(x=cohort_config, y=evaluation_first_solution_found, fill=cohort_config, colour=cohort_config)) +
    geom_flat_violin(position=position_nudge(x=.2, y=0), adjust=2) +
    geom_point(position = position_jitter(width = .15), size = .25) +
    geom_boxplot(aes(x = cohort_config, y = evaluation_first_solution_found),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
    ylab("Evaluations Required To Find Solution") + ylim(0, 78643200) + xlab("Cohort Configuration") + coord_flip() + guides(fill=FALSE, colour=FALSE) +
    scale_x_discrete(limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    ggtitle("Number of evaluations before a solution was found\nSmall or Large")
```

```{r}
eval_data <- filter(prog_solutions_e78643200, problem=="small-or-large" & sel_mode == "cohort lex" & !is.na(evaluation_first_solution_found))
kruskal.test(evaluation_first_solution_found ~ cohort_config, eval_data)
pairwise.wilcox.test(x=eval_data$evaluation_first_solution_found, g=eval_data$cohort_config, exact=FALSE, p.adjust.method = "holm")
```

#### Problem - Smallest

```{r}

ggplot(filter(prog_solutions_e78643200, problem=="smallest" & sel_mode == "cohort lex"), mapping=aes(x=cohort_config, y=evaluation_first_solution_found, fill=cohort_config, colour=cohort_config)) +
    geom_flat_violin(position=position_nudge(x=.2, y=0), adjust=2) +
    geom_point(position = position_jitter(width = .15), size = .25) +
    geom_boxplot(aes(x = cohort_config, y = evaluation_first_solution_found),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
    ylab("Evaluation Found") + ylim(0, 78643200) + xlab("K (number of cohorts)") + coord_flip() + guides(fill=FALSE, colour=FALSE) +
    scale_x_discrete(labels = c("1", "2", "4", "8", "16", "32", "64", "128", "256"), limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    ggtitle("Number of evaluations before first solution found") + 
    ggsave("smallest-first-eval-sol-found.pdf", height=15, width=10)

```

```{r}
eval_data <- filter(prog_solutions_e78643200, problem=="smallest" & sel_mode == "cohort lex" & !is.na(evaluation_first_solution_found))
kruskal.test(evaluation_first_solution_found ~ cohort_config, eval_data)
pairwise.wilcox.test(x=eval_data$evaluation_first_solution_found, g=eval_data$cohort_config, exact=FALSE, p.adjust.method = "holm")

cfgs <- c()
meds <- c()
for (cfg in levels(eval_data$cohort_config)) {
  cfgs <- c(cfgs, cfg)
  med  <- median(filter(eval_data, cohort_config==cfg)$evaluation_first_solution_found)
  meds <- c(meds, med)
  # Print!
  # print(sprintf("%s : %.1f", cfg, median(filter(eval_data, cohort_config==cfg)$evaluation_first_solution_found)))
}
df<-as.data.frame(x=cfgs)
df$medians<-meds
arrange(df, meds)
```

#### Faceted By problem
```{r}
# early_plt <- ggplot(data = filter(prog_solutions_e26214400_summary, test_mode=="SEL_COHORT_LEX" & problem != "sum-of-squares"), mapping=aes(x=cohort_config, y=solutions_found, fill=cohort_config)) +
#     geom_bar(stat="identity") + xlab("K (number of cohorts)") + ylab("Successful Runs")  +  ylim(0, 58) +
#     scale_x_discrete(labels = c("1", "2", "4", "8", "16", "32", "64", "128", "256"), limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
#     guides(fill=FALSE)+
#     geom_text(aes(label=solutions_found), nudge_y=2) + 
#     theme(axis.text.x=element_text(size=10), axis.title.x = element_text(size=10)) + 
#     coord_flip() + facet_wrap( ~ problem, labeller=as_labeller(problem_names), nrow=1) + 
#     theme(strip.text.x = element_text(size = 9)) + 
#     ggtitle("26214400 Evaluations")

ggplot(filter(prog_solutions_e78643200, sel_mode == "cohort lex" & problem!="sum-of-squares"), mapping=aes(x=cohort_config, y=evaluation_first_solution_found, fill=cohort_config, colour=cohort_config)) +
    # geom_point(position = position_jitter(width = .15), size = .25) +
    geom_boxplot(aes(x = cohort_config, y = evaluation_first_solution_found), alpha = 0.3) +
    ylab("Test Case Evaluations") + ylim(0, 78643200) + xlab("K (number of cohorts)") +  guides(fill=FALSE, colour=FALSE) +
    scale_x_discrete(labels = c("1", "2", "4", "8", "16", "32", "64", "128", "256"), limits = c("cn1:cs512", "cn2:cs256", "cn4:cs128", "cn8:cs64", "cn16:cs32", "cn32:cs16", "cn64:cs8", "cn128:cs4", "cn256:cs2")) +
    ggtitle("Number of evaluations before first solution found") + 
    facet_wrap( ~ problem, labeller=as_labeller(problem_names), nrow=1) +
    theme(axis.text.x=element_text(size=10), axis.title.x = element_text(size=10)) + 
    theme(strip.text.x = element_text(size = 9)) + 
    ggsave("faceted-first-eval-sol-found.pdf", height=7, width=15)
```

